/*
* videojs-ga - v0.4.2 - 2016-11-02
* Copyright (c) 2016 Michael Bensoussan
* Licensed MIT
*/
(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};videojs.plugin("ga",function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this;return null==b&&(b={}),d={},this.options_["data-setup"]&&(t=JSON.parse(this.options_["data-setup"]),t.ga&&(d=t.ga)),e=["loaded","percentsPlayed","secondsPlayed","start","end","seek","play","pause","resize","volumeChange","error","fullscreen"],k=b.eventsToTrack||d.eventsToTrack||e,i=b.eventCategory||d.eventCategory||"Video",c=null!=b.autoLabel?b.autoLabel:!0,j=b.eventLabel||d.eventLabel,w=b.percentsPlayedInterval||d.percentsPlayedInterval||10,B=b.secondsPlayedInterval||d.secondsPlayedInterval||60,C=b.secondsPlayedMoments||d.secondsPlayedMoments,K=b.trackReplaySeconds,v=[],E=D=0,F=!1,g=!1,M=!1,A=0,r=void 0,L=void 0,q=void 0,b.debug=b.debug||!1,p=function(){return r=Number.isFinite(O.duration()),L=a.call(k,"secondsPlayed")>=0&&(!r||b.trackFiniteSeconds),!j&&c&&(j=O.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,"")),r||b.eventCategory||d.eventCategory||(i="Stream"),H()},s=function(){p(),a.call(k,"loadedmetadata")>=0&&G("loadedmetadata",!0)},J=function(){var b,c,d,e,f;if(r){if(b=o(),c=Math.round(this.duration()),e=Math.round(b/c*100),w)for(d=f=0;99>=f;d=f+=w)e>=d&&a.call(v,d)<0&&(a.call(k,"start")>=0&&0===d&&e>0?G("start",!0):a.call(k,"percentsPlayed")>=0&&0!==e&&G("percent played",!0,d),e>0&&v.push(d));a.call(k,"seek")>=0&&(E=D,D=b,Math.abs(E-D)>1&&(F=!0,G("seek start",!1,E),G("seek end",!1,D)))}},H=function(){var b;if(L&&!M)return M=!0,b=n(),q=setInterval(function(){n()>b&&(A++,(a.call(C,A)>=0||!(A%B))&&G("seconds played",!0,A))},1e3)},I=function(){return clearInterval(q),M=!1},l=function(){return H(),a.call(k,"start")>=0&&!r?G("start",!0):void 0},f=function(){g=!0,I(),K?A=0:L=!1,G("end",!0)},x=function(){var b;H(),b=o(),(b>0||a.call(k,"start")<0)&&G("play",!0,b),g&&0===b&&K&&G("start",!0),F=!1},y=function(){H(),F=!1},u=function(){var a,b;I(),a=o(),b=Math.round(this.duration()),a===b||F||G("pause",!1,a)},N=function(){var a;a=this.muted()===!0?0:this.volume(),G("volume change",!1,a)},z=function(){G("resize - "+this.width()+"*"+this.height(),!0)},h=function(){var a;a=o(),G("error",!0,a)},m=function(){var a;a=o(),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?G("enter fullscreen",!1,a):G("exit fullscreen",!1,a)},o=function(){return r?n():A},n=function(){return Math.round(O.currentTime())},G=function(a,c,d){var e;e={eventCategory:i,eventAction:a,nonInteraction:c},null!=j&&(e.eventLabel=j),null!=d&&(e.eventValue=d),O.trigger("gaEvent",e),b.sendGaEventDirectly&&window.ga&&ga("send","event",{eventCategory:i,eventAction:a,eventLabel:j,eventValue:d,nonInteraction:c}),b.debug&&console.log(e)},this.ready(function(){return this.on("loadedmetadata",s),this.on("timeupdate",J),this.one("firstplay",l),a.call(k,"end")>=0&&this.on("ended",f),a.call(k,"play")>=0&&this.on("play",x),this.on("playing",y),a.call(k,"pause")>=0&&this.on("pause",u),a.call(k,"volumeChange")>=0&&this.on("volumechange",N),a.call(k,"resize")>=0&&this.on("resize",z),a.call(k,"error")>=0&&this.on("error",h),a.call(k,"fullscreen")>=0?this.on("fullscreenchange",m):void 0}),{sendbeacon:G}})}).call(this);