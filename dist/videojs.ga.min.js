/*
* videojs-ga - v0.4.2 - 2016-11-02
* Copyright (c) 2016 Michael Bensoussan
* Licensed MIT
*/
(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};videojs.plugin("ga",function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=this;return null==b&&(b={}),d={},this.options()["data-setup"]&&(s=JSON.parse(this.options()["data-setup"]),s.ga&&(d=s.ga)),e=["loaded","percentsPlayed","start","end","seek","play","pause","resize","volumeChange","error","fullscreen"],j=b.eventsToTrack||d.eventsToTrack||e,h=b.eventCategory||d.eventCategory||"Video",c=null!=b.autoLabel?b.autoLabel:!0,i=b.eventLabel||d.eventLabel,v=b.percentsPlayedInterval||d.percentsPlayedInterval,A=b.secondsPlayedInterval||d.secondsPlayedInterval,B=b.secondsPlayedSingleIntervals||d.secondsPlayedSingleIntervals,u=[],D=C=0,E=!1,K=!1,z=0,q=void 0,J=void 0,p=void 0,b.debug=b.debug||!1,o=function(){return q=Number.isFinite(M.duration()),J=(A||Array.isArray(B))&&(!q||b.trackFiniteSeconds),!i&&c&&(i=M.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,"")),q||b.eventCategory||d.eventCategory||(h="Stream"),G()},r=function(){o(),a.call(j,"loadedmetadata")>=0&&F("loadedmetadata",!0)},I=function(){var b,c,d,e,f;if(q){if(b=n(),c=Math.round(this.duration()),e=Math.round(b/c*100),v)for(d=f=0;99>=f;d=f+=v)e>=d&&a.call(u,d)<0&&(a.call(j,"start")>=0&&0===d&&e>0?F("start",!0):a.call(j,"percentsPlayed")>=0&&0!==e&&F("percent played",!0,d),e>0&&u.push(d));a.call(j,"seek")>=0&&(D=C,C=b,Math.abs(D-C)>1&&(E=!0,F("seek start",!1,D),F("seek end",!1,C)))}},G=function(){var b;if(J&&!K)return K=!0,b=m(),p=setInterval(function(){m()>b&&(z++,(a.call(B,z)>=0||!(z%A))&&F("seconds played",!0,z))},1e3)},H=function(){return clearInterval(p),K=!1},k=function(){return G(),a.call(j,"start")>=0&&!q?F("start",!0):void 0},f=function(){H(),F("end",!0)},w=function(){var a;G(),a=n(),F("play",!0,a),E=!1},x=function(){G(),E=!1},t=function(){var a,b;H(),a=n(),b=Math.round(this.duration()),a===b||E||F("pause",!1,a)},L=function(){var a;a=this.muted()===!0?0:this.volume(),F("volume change",!1,a)},y=function(){F("resize - "+this.width()+"*"+this.height(),!0)},g=function(){var a;a=n(),F("error",!0,a)},l=function(){var a;a=n(),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?F("enter fullscreen",!1,a):F("exit fullscreen",!1,a)},n=function(){return q?m():z},m=function(){return Math.round(M.currentTime())},F=function(a,c,d){var e;e={eventCategory:h,eventAction:a,nonInteraction:c},null!=i&&(e.eventLabel=i),null!=d&&(e.eventValue=d),M.trigger("gaEvent",e),b.sendGaEventDirectly&&window.ga&&ga("send","event",{eventCategory:h,eventAction:a,eventLabel:i,eventValue:d,nonInteraction:c}),b.debug&&console.log(e)},this.ready(function(){return this.on("loadedmetadata",r),this.on("timeupdate",I),this.one("firstplay",k),a.call(j,"end")>=0&&this.on("ended",f),a.call(j,"play")>=0&&this.on("play",w),this.on("playing",x),a.call(j,"pause")>=0&&this.on("pause",t),a.call(j,"volumeChange")>=0&&this.on("volumechange",L),a.call(j,"resize")>=0&&this.on("resize",y),a.call(j,"error")>=0&&this.on("error",g),a.call(j,"fullscreen")>=0?this.on("fullscreenchange",l):void 0}),{sendbeacon:F}})}).call(this);