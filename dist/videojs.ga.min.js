/*
* videojs-ga - v0.4.2 - 2016-11-03
* Copyright (c) 2016 Michael Bensoussan
* Licensed MIT
*/
(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};videojs.plugin("ga",function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U=this;return null==b&&(b={}),j={},this.options_["data-setup"]&&(z=JSON.parse(this.options_["data-setup"]),z.ga&&(j=z.ga)),k=["loaded","percentsPlayed","secondsPlayed","start","end","seek","play","pause","resize","volumeChange","error","fullscreen","adstart","adpause","adend","adskip","adtimeout","adserror"],q=b.eventsToTrack||j.eventsToTrack||k,o=b.eventCategory||j.eventCategory||"Video",i=null!=b.autoLabel?b.autoLabel:!0,p=b.eventLabel||j.eventLabel,C=b.percentsPlayedInterval||j.percentsPlayedInterval||10,H=b.secondsPlayedInterval||j.secondsPlayedInterval||60,I=b.secondsPlayedMoments||j.secondsPlayedMoments,Q=b.trackReplaySeconds,B=[],K=J=0,L=!1,m=!1,S=!1,G=0,x=void 0,R=void 0,w=void 0,b.debug=b.debug||!1,v=function(){return x=Number.isFinite(U.duration()),R=a.call(q,"secondsPlayed")>=0&&(!x||b.trackFiniteSeconds),!p&&i&&(p=U.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,"")),x||b.eventCategory||j.eventCategory||(o="Stream"),N()},y=function(){v(),a.call(q,"loadedmetadata")>=0&&M("loadedmetadata",!0)},P=function(){var b,c,d,e,f;if(x){if(b=u(),c=Math.round(this.duration()),e=Math.round(b/c*100),C)for(d=f=0;99>=f;d=f+=C)e>=d&&a.call(B,d)<0&&(a.call(q,"start")>=0&&0===d&&e>0?M("start",!0):a.call(q,"percentsPlayed")>=0&&0!==e&&M("percent played",!0,d),e>0&&B.push(d));a.call(q,"seek")>=0&&(K=J,J=b,Math.abs(K-J)>1&&(L=!0,M("seek start",!1,K),M("seek end",!1,J)))}},N=function(){var b;if(R&&!S)return S=!0,b=t(),w=setInterval(function(){t()>b&&(G++,(a.call(I,G)>=0||!(G%H))&&M("seconds played",!0,G))},1e3)},O=function(){return clearInterval(w),S=!1},r=function(){return N(),a.call(q,"start")>=0&&!x?M("start",!0):void 0},l=function(){m=!0,O(),Q?G=0:R=!1,M("end",!0)},D=function(){var b;N(),b=u(),(b>0||a.call(q,"start")<0)&&M("play",!0,b),m&&0===b&&Q&&M("start",!0),L=!1},E=function(){N(),L=!1},A=function(){var a,b;O(),a=u(),b=Math.round(this.duration()),a===b||L||M("pause",!1,a)},T=function(){var a;a=this.muted()===!0?0:this.volume(),M("volume change",!1,a)},F=function(){M("resize - "+this.width()+"*"+this.height(),!0)},n=function(){var a;a=u(),M("error",!0,a)},s=function(){var a;a=u(),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?M("enter fullscreen",!1,a):M("exit fullscreen",!1,a)},g=function(){return O(),a.call(q,"adstart")>=0?M("adstart",!1,u()):void 0},d=function(){return M("adpause",!1)},c=function(){return N(),M("adend",!0)},f=function(){return M("adskip",!1)},h=function(){return M("adtimeout",!0)},e=function(a){return M("adserror",!0,null!=a?a.AdError:void 0)},u=function(){return x?t():G},t=function(){return Math.round(U.currentTime())},M=function(a,c,d){var e;e={eventCategory:o,eventAction:a,nonInteraction:c},null!=p&&(e.eventLabel=p),null!=d&&(e.eventValue=d),U.trigger("gaEvent",e),b.sendGaEventDirectly&&window.ga&&ga("send","event",{eventCategory:o,eventAction:a,eventLabel:p,eventValue:d,nonInteraction:c}),b.debug&&console.log(e)},this.ready(function(){return this.on("loadedmetadata",y),this.on("timeupdate",P),this.one("firstplay",r),a.call(q,"end")>=0&&this.on("ended",l),a.call(q,"play")>=0&&this.on("play",D),this.on("playing",E),a.call(q,"pause")>=0&&this.on("pause",A),a.call(q,"volumeChange")>=0&&this.on("volumechange",T),a.call(q,"resize")>=0&&this.on("resize",F),a.call(q,"error")>=0&&this.on("error",n),a.call(q,"fullscreen")>=0&&this.on("fullscreenchange",s),a.call(q,"adstart")>=0&&this.on("adstart",g),a.call(q,"adpause")>=0&&this.on("adpause",d),a.call(q,"adend")>=0&&this.on("adend",c),a.call(q,"adskip")>=0&&this.on("adskip",f),a.call(q,"adtimeout")>=0&&this.on("adtimeout",h),a.call(q,"adserror")>=0?this.on("adserror",e):void 0}),{sendbeacon:M}})}).call(this);