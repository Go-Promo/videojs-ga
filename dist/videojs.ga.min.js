/*
* videojs-ga - v0.4.2 - 2016-11-02
* Copyright (c) 2016 Michael Bensoussan
* Licensed MIT
*/
(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};videojs.plugin("ga",function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=this;return null==b&&(b={}),c={},this.options()["data-setup"]&&(r=JSON.parse(this.options()["data-setup"]),r.ga&&(c=r.ga)),d=["loaded","percentsPlayed","start","end","seek","play","pause","resize","volumeChange","error","fullscreen"],i=b.eventsToTrack||c.eventsToTrack||d,g=b.eventCategory||c.eventCategory||"Video",h=b.eventLabel||c.eventLabel,u=b.percentsPlayedInterval||c.percentsPlayedInterval,z=b.secondsPlayedInterval||c.secondsPlayedInterval,A=b.secondsPlayedSingleIntervals||c.secondsPlayedSingleIntervals,t=[],C=B=0,D=!1,J=!1,y=0,p=void 0,I=void 0,o=void 0,b.debug=b.debug||!1,n=function(){return p=Number.isFinite(L.duration()),I=(z||Array.isArray(A))&&(!p||b.trackFiniteSeconds),h||(h=L.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,"")),p||b.eventCategory||c.eventCategory||(g="Stream"),F()},q=function(){n(),a.call(i,"loadedmetadata")>=0&&E("loadedmetadata",!0)},H=function(){var b,c,d,e,f;if(p){if(b=m(),c=Math.round(this.duration()),e=Math.round(b/c*100),u)for(d=f=0;99>=f;d=f+=u)e>=d&&a.call(t,d)<0&&(a.call(i,"start")>=0&&0===d&&e>0?E("start",!0):a.call(i,"percentsPlayed")>=0&&0!==e&&E("percent played",!0,d),e>0&&t.push(d));a.call(i,"seek")>=0&&(C=B,B=b,Math.abs(C-B)>1&&(D=!0,E("seek start",!1,C),E("seek end",!1,B)))}},F=function(){var b;if(I&&!J)return J=!0,b=l(),o=setInterval(function(){l()>b&&(y++,(a.call(A,y)>=0||!(y%z))&&E("seconds played",!0,y))},1e3)},G=function(){return clearInterval(o),J=!1},j=function(){return F(),a.call(i,"firstplay")>=0?E("firstplay",!0):void 0},e=function(){G(),E("end",!0)},v=function(){var a;F(),a=m(),E("play",!0,a),D=!1},w=function(){F(),D=!1},s=function(){var a,b;G(),a=m(),b=Math.round(this.duration()),a===b||D||E("pause",!1,a)},K=function(){var a;a=this.muted()===!0?0:this.volume(),E("volume change",!1,a)},x=function(){E("resize - "+this.width()+"*"+this.height(),!0)},f=function(){var a;a=m(),E("error",!0,a)},k=function(){var a;a=m(),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?E("enter fullscreen",!1,a):E("exit fullscreen",!1,a)},m=function(){return p?l():y},l=function(){return Math.round(L.currentTime())},E=function(a,c,d){var e;e={eventCategory:g,eventAction:a,nonInteraction:c},null!=h&&(e.eventLabel=h),null!=d&&(e.eventValue=d),L.trigger("gaEvent",e),b.debug&&console.log(e)},this.ready(function(){return this.on("loadedmetadata",q),this.on("timeupdate",H),this.one("firstplay",j),a.call(i,"end")>=0&&this.on("ended",e),a.call(i,"play")>=0&&this.on("play",v),this.on("playing",w),a.call(i,"pause")>=0&&this.on("pause",s),a.call(i,"volumeChange")>=0&&this.on("volumechange",K),a.call(i,"resize")>=0&&this.on("resize",x),a.call(i,"error")>=0&&this.on("error",f),a.call(i,"fullscreen")>=0?this.on("fullscreenchange",k):void 0}),{sendbeacon:E}})}).call(this);